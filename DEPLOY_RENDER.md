# Render平台部署指南

本文档提供了在Render平台上部署直播辩论系统的详细步骤。

## 准备工作

1. **创建Render账户**
   - 访问 [Render官网](https://render.com) 注册账户
   - 完成邮箱验证

2. **GitHub仓库准备**
   - 将本项目Fork到您的GitHub账户
   - 确保您的仓库对Render可见

3. **检查项目配置**
   - 确保项目根目录包含`render.yaml`文件
   - 检查配置文件中的服务名称和端口设置

## 部署步骤

### 1. 使用Blueprint部署

Render支持使用Blueprint（蓝图）功能一次性部署多个服务，这非常适合我们的三层架构。

1. 登录Render账户
2. 点击顶部导航栏中的"New"按钮
3. 选择"Blueprint"选项
4. 在代码库部分，选择您Fork的项目仓库
5. 确认GitHub仓库已正确连接
6. 点击"Apply"按钮开始部署

### 2. 等待部署完成

部署过程将自动完成以下操作：

1. 为每个服务（后端、前端、网关）创建单独的Web服务
2. 自动设置服务之间的环境变量引用
3. 安装依赖并启动服务
4. 分配公网URL

部署时间取决于项目大小和网络状况，通常需要5-15分钟。

### 3. 验证部署结果

部署完成后，您可以通过以下方式验证各服务是否正常运行：

1. 访问网关服务URL（主要访问入口）
2. 访问管理后台：`https://[gateway-url]/admin`
3. 检查各服务的日志输出，确保没有错误

## 环境变量配置

在Render平台上，服务之间的依赖关系已经通过`render.yaml`中的`fromService`配置自动设置。主要的环境变量包括：

- **PORT**: 服务运行端口
- **NODE_ENV**: 环境模式（production）
- **BACKEND_URL**: 后端服务URL（网关服务自动注入）
- **FRONTEND_URL**: 前端服务URL（网关服务自动注入）

如需手动修改环境变量：

1. 进入Render控制台
2. 选择相应的服务
3. 点击"Environment"选项卡
4. 添加或修改环境变量
5. 保存并重启服务

## 常见问题解决

### 1. 服务启动失败

- 检查服务日志，查找错误信息
- 确认依赖是否正确安装
- 检查端口是否被占用

### 2. 服务之间无法通信

- 确认环境变量是否正确设置
- 检查防火墙设置
- 验证服务URL是否可访问

### 3. WebSocket连接问题

- 确保Render计划支持WebSocket
- 检查网络配置
- 查看WebSocket相关日志

## 维护和更新

### 更新代码

当您更新GitHub仓库中的代码后，Render会自动重新部署服务。您也可以手动触发部署：

1. 进入Render控制台
2. 选择相应的服务
3. 点击"Manual Deploy"按钮

### 查看日志

1. 进入Render控制台
2. 选择相应的服务
3. 点击"Logs"选项卡查看日志输出

### 重启服务

1. 进入Render控制台
2. 选择相应的服务
3. 点击"Restart"按钮重启服务

## 注意事项

1. Render的免费计划有资源限制，可能会影响服务性能
2. 免费计划下，非活跃服务会自动休眠
3. 由于使用模拟数据，服务重启后数据会重置
4. 如需持久化数据，建议集成云数据库服务

## 扩展建议

1. 集成MongoDB Atlas作为持久化数据库
2. 使用Redis缓存提高性能
3. 配置自定义域名
4. 设置监控和告警系统

## 联系支持

如有部署相关问题，您可以：

1. 查看Render官方文档
2. 联系Render客服支持
3. 提交Issue到项目仓库

---

祝您部署顺利！